<!DOCTYPE html>
<html>
<head>
    <title>チャットサイト</title>
</head>
<body>
    <h1>ようこそ、チャットサイトへ</h1>
    
    <!-- チャットメッセージを表示する領域 -->
    <div id="chat">
        <!-- チャットメッセージはここに表示されます -->
    </div>

    <!-- メッセージを入力するフォーム -->
    <input type="text" id="message" placeholder="メッセージを入力">
    <button onclick="sendMessage()">送信</button>

    <!-- Firebase JavaScript SDKの読み込み -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase.js"></script>
    <script>
        // Firebaseの設定
        const firebaseConfig = {
            apiKey: "AIzaSyBVGCRikCSnxTCnnIHHK15711fUQJ50GL0",
            authDomain: "hamanan1.firebaseapp.com",
            databaseURL: "https://hamanan1-default-rtdb.firebaseio.com",
            projectId: "hamanan1",
            storageBucket: "hamanan1.appspot.com",
            messagingSenderId: "939524742350",
            appId: "1:939524742350:web:8de2d227935bbab1c0049f",
            measurementId: "G-G536JMTWHC"
        };

        // Firebaseの初期化
        firebase.initializeApp(firebaseConfig);

        // Firebase Realtime Databaseへメッセージを送信する関数
        function sendMessage() {
            const messageInput = document.getElementById("message");
            const message = messageInput.value;

            // Firebase Realtime Databaseへのメッセージ送信コードを追加
            const database = firebase.database();
            const messagesRef = database.ref("messages");

            messagesRef.push().set({
                text: message,
                timestamp: Date.now()
            });

            // メッセージを送信した後、入力フィールドをクリア
            messageInput.value = "";
        }

        // メッセージを受信して表示する処理
        const chatDiv = document.getElementById("chat");
        const database = firebase.database();
        const messagesRef = database.ref("messages");

        messagesRef.on("child_added", function (snapshot) {
            const message = snapshot.val();
            const messageText = message.text;
            const messageTimestamp = new Date(message.timestamp).toLocaleTimeString();
            const messageElement = document.createElement("p");
            messageElement.innerText = `[${messageTimestamp}] ${messageText}`;
            chatDiv.appendChild(messageElement);
        });
    </script>
</body>
</html>
