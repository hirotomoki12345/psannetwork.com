<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>検索アプリ</title>
</head>
<body>

<!-- キーワード入力用のフォーム -->
<form id="searchForm">
  <label for="keyword">検索キーワード:</label>
  <input type="text" id="keyword" name="keyword">
  <button type="button" onclick="performSearch()">検索</button>
</form>

<!-- 結果を表示するための要素 -->
<div id="searchResults"></div>

<script>
  function performSearch() {
    // Google Apps ScriptのウェブアプリケーションのURL
    var url = 'https://script.google.com/macros/s/AKfycbw6QRmHXwKJo39yG7J4JGy7lBUsAA7OrfPoKZjs8fAi7xKXscoTqG9w4-gDYVwVHLM/exec';

    // フォームからキーワードを取得
    var keyword = document.getElementById('keyword').value;

    // キーワードをURLに追加
    url += '?text=' + encodeURIComponent(keyword);

    // データを取得して処理する
    fetch(url)
      .then(response => response.json())
      .then(data => {
        // レスポンスデータから必要な情報を抽出
        var results = data.results.map(result => result.columnB);

        // 結果を新しい要素に追加して表示
        var resultsContainer = document.getElementById('searchResults');
        resultsContainer.innerHTML = '<p>検索結果:</p><ul><li>' + results.join('</li><li>') + '</li></ul>';
      })
      .catch(error => {
        // エラーが発生した場合はアラートで表示
        alert('エラー:\n' + error);
      });
  }
</script>

</body>
</html>
