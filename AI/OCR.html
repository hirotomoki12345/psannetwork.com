<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>画像リクエスト</title>
</head>
<body>
  <input type="file" id="imageInput" accept="image/*">
  <button onclick="sendImage()">画像を送信</button>

  <script>
    async function sendImage() {
      var fileInput = document.getElementById('imageInput');
      var file = fileInput.files[0];

      if (file) {
        try {
          var imageData = await readFileAsBase64(file);

          // Google Apps ScriptのWebアプリのURLを指定
          var scriptUrl = 'https://script.google.com/macros/s/AKfycbzT3190PJIvOTBTyRbhlQIfzijwG2CG08QdJBflvCJq_GUfsrvKLLMyzfI7XgRkBBr3/exec';

          // POSTリクエストを送信
          var response = await fetch(scriptUrl, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ imageData: imageData }),
          });

          if (response.ok) {
            var responseData = await response.json();

            // レスポンスの処理
            if (responseData.ocrResult) {
              alert('OCR結果:\n' + responseData.ocrResult);
            } else if (responseData.error) {
              alert('エラー: ' + responseData.error);
            } else {
              alert('不明なエラーが発生しました');
            }
          } else {
            alert('リクエストが失敗しました');
          }
        } catch (error) {
          console.error('エラー:', error);
        }
      } else {
        alert('画像を選択してください');
      }
    }

    function readFileAsBase64(file) {
      return new Promise((resolve, reject) => {
        var reader = new FileReader();
        reader.onload = function () {
          resolve(reader.result.split(',')[1]);
        };
        reader.onerror = function (error) {
          reject(error);
        };
        reader.readAsDataURL(file);
      });
    }
  </script>
</body>
</html>
